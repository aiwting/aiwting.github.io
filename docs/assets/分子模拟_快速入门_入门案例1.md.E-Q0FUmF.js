import{_ as p,C as t,c as h,o as k,ag as n,j as s,G as F,a,w as e}from"./chunks/framework.Bw-5EFTY.js";const Q=JSON.parse('{"title":"入门案例1","description":"","frontmatter":{},"headers":[],"relativePath":"分子模拟/快速入门/入门案例1.md","filePath":"分子模拟/快速入门/入门案例1.md","lastUpdated":null}'),r={name:"分子模拟/快速入门/入门案例1.md"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.266ex",height:"2.14ex",role:"img",focusable:"false",viewBox:"0 -864 4095.6 946","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.971ex",height:"1.937ex",role:"img",focusable:"false",viewBox:"0 -833.9 9711.3 855.9","aria-hidden":"true"};function E(B,i,o,c,m,u){const l=t("big");return k(),h("div",null,[i[14]||(i[14]=n(`<h1 id="入门案例1" tabindex="-1">入门案例1 <a class="header-anchor" href="#入门案例1" aria-label="Permalink to &quot;入门案例1&quot;">​</a></h1><p>新手的第一个GROMACS案例——<strong>水中的溶菌酶</strong></p><ul><li>该教程来自弗吉尼亚理工大学生物化学系的分子动力学教程：www.mdtutorials.com</li><li>该模拟流程完整清晰，符合一个GROMACS模拟的标准流程，足够简单不需要复杂的准备工作，<strong>是了解GROMACS基本操作的入门案例</strong>.</li><li>此案例将模拟一个包含一个溶菌酶分子的简单的水系统，通过此案例，将实际了解GROMACS执行MD的具体流程，基本命令操作.</li></ul><h2 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h2><h3 id="环境及软件准备" tabindex="-1">环境及软件准备 <a class="header-anchor" href="#环境及软件准备" aria-label="Permalink to &quot;环境及软件准备&quot;">​</a></h3><p>如果你按照上一小节的教程安装了 <em>GROMACS及额外的模拟软件</em>, 里面包含了本节需要的可视化工具 VMD.</p><ul><li>首先需要 <em>安装GROMACS</em>，这里默认你使用的是Windows版或者是WSL中的GROMACS</li><li>VMD 工具用来可视化分子结构和模拟轨迹</li><li>Grace 用来将xvg文件绘制成图表 <ul><li>因为grace的版本不同, 调用grace的命令可能是: <code>xmgrace</code>, <code>qtgrace</code>, <code>grace</code></li><li>如果还没有安装grace绘图程序，且你正在使用的是ubuntu系统，可以使用<code>sudo atp-get install grace</code>命令安装。</li></ul></li></ul><h3 id="gromacs初识" tabindex="-1">GROMACS初识 <a class="header-anchor" href="#gromacs初识" aria-label="Permalink to &quot;GROMACS初识&quot;">​</a></h3><ul><li>GROMACS的所有工具都是以命令形式调用，所以需要在命令行界面操作。命令格式形如：<code>gmx &lt;module&gt; &lt;parameters&gt;</code><ul><li>module 是各种GROMACS工具，可以完成生成拓扑参数、构建盒子、添加溶剂、添加离子、执行模拟计算等功能.</li><li>parameters 规定了一条GROMACS命令具体的输入与输出文件，以及一些可选项.</li><li>例如，想要查询一个GROMACS工具可以接受的参数，使用 <code>gmx &lt;module&gt; -h</code>，输出依次是： <ul><li>程序在电脑中的路径</li><li>GROMACS的安装路径</li><li>当前的工作目录</li><li>输入的命令</li><li>该工具的语法、描述、可选项、其它选项、</li><li>最后是GROMACS程序的提示语（提示语没用，但看到它表示此次命令执行成功）。</li></ul></li></ul></li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdb2gmx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx pdb2gmx, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/ms</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdb2gmx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SYNOPSIS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdb2gmx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-f [&lt;.gro/.g96/...&gt;]] [-o [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gro/.g96/...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]] [-p [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.top</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-i [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.itp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]] [-n [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.ndx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]] [-q [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gro/.g96/...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-chainsep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [-merge </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [-ff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [-water </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-[no]inter] [-[no]ss] [-[no]ter] [-[no]lys] [-[no]arg]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-[no]asp] [-[no]glu] [-[no]gln] [-[no]his] [-angle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [-[no]una] [-[no]ignh] [-[no]missing] [-[no]v]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-posrefc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [-vsite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [-[no]heavyh] [-[no]deuterate]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [-[no]chargegrp] [-[no]cmap] [-[no]renum] [-[no]rtpres]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DESCRIPTION</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OPTIONS</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Other</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> options:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;If we knew what it was we were doing, it would not be called research, would it?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Albert </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Einstein</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="文件准备" tabindex="-1">文件准备 <a class="header-anchor" href="#文件准备" aria-label="Permalink to &quot;文件准备&quot;">​</a></h3><ul><li>获得蛋白质结构文件，去<a href="https://www.rcsb.org/" target="_blank" rel="noreferrer">RCSB</a>网站下载溶菌酶的pdb文件，通过 PDB ID 搜索 &quot;1AKI&quot; &gt;点击右侧“Download Files” &gt;&quot;Legacy PDB Format&quot;，将得到&quot;1aki.pdb&quot;文件.</li><li>打开 &quot;1aki.pdb&quot; 文件，可以看到其中包含了结晶水&quot;HOH&quot;，删除所有&quot;HOH&quot;所在行，命名为&quot;1aki-h2o.pdb&quot;, 使用Linux命令实现: <code>grep -v HOH 1aki.pdb &gt; 1aki-h2o.pdb</code></li><li>注意检查蛋白质pdb文件结构，一个标准的蛋白质pdb文件包含了： <ul><li>文件标题 HEADER</li><li>实验数据和元数据 REMARK</li><li>残基序列 SEQRES</li><li>二级和三级结构信息 HELIX SHEET</li><li>晶体学信息 CRYST1</li><li>二硫键 SSBOND</li><li>原子坐标 ATOM</li><li>非标准残基或配体的原子 HETATM</li><li>原子之间的连接关系 CONECT</li><li>TER 用于标识链的结束</li><li>MODEL 用于多模型结构的描述等等.</li></ul></li></ul>`,12)),s("p",null,[F(l,null,{default:e(()=>i[0]||(i[0]=[a("本节教程使用的所有文件打包在此")])),_:1,__:[0]}),i[1]||(i[1]=a(": ")),i[2]||(i[2]=s("a",{href:"https://pan.baidu.com/s/1eglrcdUy_04_14xQWatAmw?pwd=994j",target:"_blank",rel:"noreferrer"},"百度网盘下载",-1))]),i[15]||(i[15]=n(`<h2 id="步骤1-生成拓扑结构" tabindex="-1">步骤1-生成拓扑结构 <a class="header-anchor" href="#步骤1-生成拓扑结构" aria-label="Permalink to &quot;步骤1-生成拓扑结构&quot;">​</a></h2><blockquote><p>GROMACS工具：pdb2gmx</p></blockquote><ul><li>pdb2gmx命令会生成三个文件： <ol><li>分子的拓扑结构.top</li><li>位置限制文件.itp</li><li>GROMACS格式的结构文件.gro</li></ol></li><li>需要输入数字来选择力场和水模型，相关信息将写入top文件中。力场选择&quot;AMBER99SB&quot;，水模型无特殊需求选择简单点电荷水即可&quot;TIP3P&quot;</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdb2gmx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki-h2o.pdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.itp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.gro</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx pdb2gmx, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdb2gmx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki-h2o.pdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.itp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.gro</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Field:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">From</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/home/zz/miniconda3/envs/md/share/gromacs/top&#39;:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protein,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nucleic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER94</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Duan </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">et</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> al.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> J.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Comp.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Chem.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 24,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1999-2012,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2003</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER94</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Cornell </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">et</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> al.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> JACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 117,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5179-5197,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1995</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protein,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nucleic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER94</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Kollman </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">et</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> al.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Acc.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Chem.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Res.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 29,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 461-469,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1996</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 4:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER99</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protein,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nucleic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER94</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Wang </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">et</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> al.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> J.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Comp.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Chem.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 21,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1049-1074,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 5:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER99SB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protein,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nucleic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER94</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Hornak </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">et</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> al.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Proteins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 65,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 712-725,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2006</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 6:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER99SB-ILDN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protein,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nucleic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBER94</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Lindorff-Larsen </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">et</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> al.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Proteins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 78,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1950-58,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2010</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 7:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AMBERGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Garcia &amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sanbonmatsu,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PNAS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 99,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2782-2787,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2002</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 8:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CHARMM27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all-atom</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (CHARM22 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">plus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CMAP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proteins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 9:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMOS96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 43a1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMOS96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 43a2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (improved </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">alkane</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dihedrals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">11:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMOS96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 45a3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Schuler </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">JCC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1205</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">12:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMOS96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 53a5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (JCC </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vol</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pag</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1656</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">13:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMOS96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 53a6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (JCC </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vol</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pag</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1656</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">14:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMOS96</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 54a7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Eur. </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Biophys.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> J.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (2011), 40,, 843-856, DOI: 10.1007/s00249-011-0700-9)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">15:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OPLS-AA/L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all-atom</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (2001 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aminoacid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dihedrals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Amber99sb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amber99sb.ff</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Opening</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/zz/miniconda3/envs/md/share/gromacs/top/amber99sb.ff/watermodels.dat</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Water</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Model:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIP3P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     TIP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3-point,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> recommended</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIP4P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     TIP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4-point</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIP4P-Ew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  TIP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4-point</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> optimized</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Ewald,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> recommended</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 4:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIP5P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     TIP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5-point</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (see </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://gitlab.com/gromacs/gromacs/-/issues/1348</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> issues</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 5:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SPC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       simple</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> point</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> charge</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 6:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SPC/E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     extended</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simple</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> point</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> charge</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 7:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> None</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">going</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rename</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amber99sb.ff/aminoacids.r2b</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Opening</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/zz/miniconda3/envs/md/share/gromacs/top/amber99sb.ff/aminoacids.r2b</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Analyzing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mass</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14313.332</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a.m.u.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> charge</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> e</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Writing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topology</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Writing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coordinate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ---------</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PLEASE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> have</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topology</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki-h2o.pdb.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Amber99sb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> field</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tip3p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> water</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> model</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> used.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ---------</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ETON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ESAELP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;The Carpenter Goes Bang Bang&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (The </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Breeders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>现在使用VMD观察 1aki.gro 文件, 先输入命令<code>vmd 1aki.gro</code>打开VMD, 然后在命令窗口输入 <code>pbc box</code>回车, 会发现蛋白质没有完全在盒子内, 接下来进行调整.</li></ul><h2 id="步骤2-调整模拟盒子" tabindex="-1">步骤2-调整模拟盒子 <a class="header-anchor" href="#步骤2-调整模拟盒子" aria-label="Permalink to &quot;步骤2-调整模拟盒子&quot;">​</a></h2><blockquote><p>GROMACS工具：editconf</p></blockquote><ul><li>使用简单的立方体作为盒子，将蛋白质剧中，距离边界至少0.2nm</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> editconf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_newbox.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -bt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cubic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx editconf, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> editconf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_newbox.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -bt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cubic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Note</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> major</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> planned</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> future</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> editconf,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> improve</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> usability</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> utility.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Read</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1960</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atoms</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Volume:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123.376</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nm^3,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> corresponds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> roughly</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 55500</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> electrons</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velocities</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.817</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  4.234</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.454</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    diameter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  5.010</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    center</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2.781</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2.488</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.017</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vectors</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  5.906</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  6.845</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.052</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> angles</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  90.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  90.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  90.00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (degrees)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123.38</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               (nm^3)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    shift</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -0.076</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.217</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2.688</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> center</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2.705</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2.705</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2.705</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vectors</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  5.410</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  5.410</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  5.410</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> angles</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  90.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  90.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  90.00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (degrees)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 158.35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               (nm^3)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Back</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Off!</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> I</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_newbox.gro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./#1aki_newbox.gro.1#</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Predictions can be very difficult - especially about the future.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Niels </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Bohr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>再次使用VMD观察&quot;1aki_newbox.gro&quot;，可以看到盒子蛋白质已经位于盒子中央.</li></ul><h2 id="步骤3-添加溶剂-溶剂化蛋白质" tabindex="-1">步骤3-添加溶剂(溶剂化蛋白质) <a class="header-anchor" href="#步骤3-添加溶剂-溶剂化蛋白质" aria-label="Permalink to &quot;步骤3-添加溶剂(溶剂化蛋白质)&quot;">​</a></h2><blockquote><p>GROMACS工具：solvate</p></blockquote><ul><li>使用水模型 <code>spc216.gro</code>（这是一个通用的三点水模型）填充盒子，并指定更新top文件（因为引入了新的分子，每次向盒子中添加新分子都需要更新top文件）</li><li>注意这里重复使用了&quot;1aki.top&quot;文件名，因此原来的文件将被备份为&quot;#1aki.top.1#&quot;</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_newbox.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spc216.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx solvate, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_newbox.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spc216.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Reading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configuration</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Generating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configuration</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configuration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> contains</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15373</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atoms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4600</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> residues</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     158.347</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nm^3)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Density</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1004.79</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (g/l)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecules:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   4471</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Processing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topology</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Adding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4471</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (SOL) to topology file (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1aki.top</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Back</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Off!</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> I</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./#1aki.top.1#</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;I wanted to have a real language where programmers could write real programs, and see whether they would find the idea of data abstraction at </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">all useful.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Barbara </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Liskov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>重新观察一下新的&quot;1aki.top&quot;文件，最下面将多一行&quot;SOL 4471&quot;表示4471个溶剂分子</li></ul><div class="language-1aki.top vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">1aki.top</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[ molecules ]</span></span>
<span class="line"><span>; Compound        #mols</span></span>
<span class="line"><span>Protein_chain_A     1</span></span>
<span class="line"><span>SOL              4471</span></span></code></pre></div><ul><li>可以用VMD查看一下新的结构文件&quot;1aki_solvate.gro&quot;，可以看到水分子充满了盒子，溶菌酶被包裹在中间。</li></ul><h2 id="步骤4-添加离子" tabindex="-1">步骤4-添加离子 <a class="header-anchor" href="#步骤4-添加离子" aria-label="Permalink to &quot;步骤4-添加离子&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp和genion</p></blockquote><ul><li>如果你注意pdb2gmx命令的输出，可以看到溶菌酶的净电荷为+8e ：&quot;Total charge 8.000 e&quot;，因此需要添加离子中和。</li><li>genion工具需要读取扩展名为.tpr的文件，因此首先用grompp工具先生成tpr文件</li><li>要使用grompp生成一个.tpr文件，还需要一个扩展名为.mdp的文件，可以在此处下载示例 <a href="https://aiwting.github.io/1/ions.mdp" target="_blank" rel="noreferrer">ions.mdp</a> 文件</li><li>grompp将动力学参数、结构信息、拓扑参数三部分信息整理成二进制的tpr文件。</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.tpr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx grompp, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.tpr</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> random</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1608515534</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NOTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [file </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1aki.top,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18409]:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> non-zero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> charge:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.000000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> charge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> should</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> normally</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> an</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> integer.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> See</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  https://manual.gromacs.org/current/user-guide/floating-point.html</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> discussion on how close it should be to an integer.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Analysing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> residue</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> names:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   129</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Protein</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> residues</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  4471</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Water</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> residues</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Analysing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Protein...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> degrees</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> freedom</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> T-Coupling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32703.00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> integrator</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> provide</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ensemble</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temperature,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> there</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ensemble</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temperature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NOTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [file </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ions.mdp]:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> plain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cut-off,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> which</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> might</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> produce</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> artifacts.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> might</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> want</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> consider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> electrostatics.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> roughly</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> were</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOTEs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;The future always gets twisted and turned&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Lisa </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Piu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>接下来正式添加离子，指定阳离子为钠离子，阴离子为氯离子，使体系保持电中性 &quot;-neutral&quot;，并更新top文件.</li><li>过程中需要输入溶剂组&quot;SOL&quot;对应的数字.</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> genion</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate_ions.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NA</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CL</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -neutral</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx genion, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> genion</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate_ions.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NA</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CL</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -neutral</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Reading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.tpr,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2024.3-conda_forge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (single </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">precision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Reading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.tpr,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2024.3-conda_forge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (single </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">precision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> try</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ions.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> continuous</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecules</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (         </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">System</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has 15373 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (        </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Protein</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has  1960 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Protein-H</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has  1001 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (        </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">C-alpha</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has   129 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (       </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Backbone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has   387 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MainChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has   517 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MainChain+Cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has   634 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MainChain+H</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has   646 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SideChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has  1314 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SideChain-H</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has   484 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Prot-Masses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has  1960 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non-Protein</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has 13413 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (          </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Water</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has 13413 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (            </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SOL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has 13413 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non-Water</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) has  1960 elements</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 13</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Selected</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 13:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;SOL&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (3-atomic) solvent molecules: 4471</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Processing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topology</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topology</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (1aki.top)  by 0 NA and 8 CL ions.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Back</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Off!</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> I</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./#1aki.top.2#</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> random</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -54592018.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 855</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4525</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 232</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2656</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1855</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7525</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4162</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14446</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 72</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2176</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3463</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12349</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4122</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14326</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Replacing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> solvent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> molecule</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1838</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (atom </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7474</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) with CL</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Torture numbers, and they&#39;ll confess to anything.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Greg </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Easterbrook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>现在检查一下新的top文件，最下面应该多了&quot;CL 8&quot;</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[ molecules ]</span></span>
<span class="line"><span>; Compound        #mols</span></span>
<span class="line"><span>Protein_chain_A     1</span></span>
<span class="line"><span>SOL         4463</span></span>
<span class="line"><span>CL               8</span></span></code></pre></div><h2 id="步骤5-能量最小化" tabindex="-1">步骤5-能量最小化 <a class="header-anchor" href="#步骤5-能量最小化" aria-label="Permalink to &quot;步骤5-能量最小化&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp, mdrun, energy</p></blockquote><ul><li>在开始动力学之前，必须确保系统没有空间冲突或不适当的几何形状（尤其是对于自行绘制的分子结构，你没有办法精确的控制没个键长、键角的数值），通过能量最小化（EM）的过程来使得分子结构合理化。</li><li>但凡设计到使用grompp生成tpr文件，都需要mdp动力学参数文件，可以使用这里的示例 <a href="https://aiwting.github.io/1/em.mdp" target="_blank" rel="noreferrer">em.mdp</a> 文件。</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate_ions.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.tpr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx grompp, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki_solvate_ions.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.tpr</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NOTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [file </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">em.mdp]:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  With</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Verlet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lists</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> optimal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nstlist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPUs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 20.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Note</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Verlet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scheme,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nstlist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> effect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accuracy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simulation.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> roughly</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> was</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOTE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Youth is wasted on the young&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (The </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Smashing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pumpkins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>然后执行能量最小化计算 <ul><li><code>-deffnm em</code> 简写方法，意思是让mdrun工具以em为名的tpr文件为输入，并使得使出的各种格式的文件以em名字命名。</li><li><code>-v</code> 表示在命令行中显示计算过程</li></ul></li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -deffnm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx mdrun, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -deffnm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> measure</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timings</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> more</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accurately</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> than</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> was</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configured</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> might</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> affect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simulation</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">speed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accurate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timings</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> needed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load-balancing.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> consider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rebuilding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GMX_USE_RDTSCP=ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CMake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> option.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Reading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.tpr,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2024.3-conda_forge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (single </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">precision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> selected</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mapping</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IDs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rank</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  PP:0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tasks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (non-perturbed) short-ranged interactions on the GPU</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> constrain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coordinates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Using</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thread</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Using</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OpenMP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> threads</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Steepest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Descents:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Tolerance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Fmax)   =  1.00000e+03</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> steps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        50000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    0,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dmax=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.0e-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nm,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Epot=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -9.63828e+04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fmax=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.83369e+05,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atom=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 252</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dmax=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.0e-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nm,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Epot=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1.13756e+05</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fmax=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 6.57749e+04,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atom=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1367</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    2,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dmax=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.2e-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nm,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Epot=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1.32426e+05</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fmax=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3.07926e+04,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atom=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1367</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">writing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lowest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coordinates.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Steepest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Descents</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> converged</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fmax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 336</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> steps</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Potential</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -2.2477358e+05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Maximum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  9.9712384e+02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atom</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 736</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Norm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  3.6471184e+01</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;First off, I&#39;d suggest printing out a copy of the GNU coding standards, and NOT read it. Burn them, it&#39;s a great symbolic gesture.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Linus </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Torvalds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,31)),s("ul",null,[i[12]||(i[12]=s("li",null,[a("计算完成后将得到四个文件 "),s("ol",null,[s("li",null,"em.log：日志文件"),s("li",null,"em.edr：二进制能量文件"),s("li",null,"em.trr：二进制轨迹文件"),s("li",null,"em.gro：能量最小化结构")])],-1)),s("li",null,[i[11]||(i[11]=a("如何确定EM是否成功？ ")),s("ul",null,[s("li",null,[i[5]||(i[5]=a("势能：Epot 应该是负的，对于水中的简单蛋白质应该在 ")),s("mjx-container",d,[(k(),h("svg",g,i[3]||(i[3]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mo" transform="translate(1658.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(2659,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" style="stroke-width:3;"></path></g></g></g></g>',1)]))),i[4]||(i[4]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mn",null,"10"),s("mn",null,"5")]),s("mo",null,"−"),s("msup",null,[s("mn",null,"10"),s("mn",null,"6")])])],-1))]),i[6]||(i[6]=a(" 的数量级上"))]),s("li",null,[i[9]||(i[9]=a("最大力：Fmax 一般不大于 ")),s("mjx-container",C,[(k(),h("svg",y,i[7]||(i[7]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2000,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2521,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3376.2,0)"><path data-c="B7" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(3876.4,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4754.4,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(5239.4,0)"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(331,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mo" transform="translate(6746.3,0)"><path data-c="B7" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(7246.6,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(7846.6,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(911,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g></g></g></g></g>',1)]))),i[8]||(i[8]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1000"),s("mi",null,"k"),s("mi",null,"J"),s("mo",null,"·"),s("mi",null,"m"),s("mi",null,"o"),s("msup",null,[s("mi",null,"l"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"·"),s("mi",null,"n"),s("msup",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,"−"),s("mn",null,"1")])])])],-1))])]),i[10]||(i[10]=s("li",null,"由于本次、模拟个体系很简单，而且蛋白质来源于PDB数据库，本身是一个较合理的结构，在很快的几百步计算下就完成了优化。",-1))])]),i[13]||(i[13]=s("li",null,[a("简单的看一下能量变化，em.edr文件包含GROMACS在EM期间收集的所有能量项，可以使用GROMACS energy 模块分析任何.edr文件： "),s("ul",null,[s("li",null,[a("过程中需要键入 "),s("code",null,"10 0"),a("，10表示选择Potential，0表示终止输入。将输出Epot的平均值，以及一个名为“potential.xvg”的文件。")])])],-1))]),i[16]||(i[16]=n(`<div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.edr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> potential.xvg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx energy, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.edr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> potential.xvg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Opened</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.edr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> single</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> precision</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> terms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> want</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">selecting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> either</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (part </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) the name or the number or a combination.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">End</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> selection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> an</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> empty</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zero.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Bond</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">             2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Angle</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Proper-Dih.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Per.-Imp.-Dih.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  LJ-14</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Coulomb-14</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  LJ-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Coulomb-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Coul.-recip.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Potential</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pressure</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-XX</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-XY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          14</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-XZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-YX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-YY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 17</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-YZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-ZX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          19</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-ZY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-ZZ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-XX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-XY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         23</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-XZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-YX</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-YY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-YZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-ZX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-ZY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-ZZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         30</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  #Surf*SurfTen   31  T-rest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Last</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frame</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> read</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 265</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  335.000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Statistics</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> over</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 336</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> through</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 335.0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ],</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sets</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">All</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> statistics</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> over</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 266</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> points</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (frames)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      Average</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Err.Est.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RMSD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Tot-Drift</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Potential</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                   -213378</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       5900</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    15542.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   -39018.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (kJ/mol)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;This Puke Stinks Like Beer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (LIVE)</span></span></code></pre></div><ul><li>然后使用绘图工具可以绘制能量变化曲线，例如使用xmgrace程序，命令行输入 <code>xmgrace potential.xvg</code>，结果图应该看起来像如下图：展示了Epot的良好稳定收敛。</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-1.png" width="60%" align="center"></p><p><em>系统的总能量变化</em> :::</p><h2 id="步骤6-nvt平衡" tabindex="-1">步骤6-NVT平衡 <a class="header-anchor" href="#步骤6-nvt平衡" aria-label="Permalink to &quot;步骤6-NVT平衡&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp, mdrun, energy</p></blockquote><ul><li>平衡通常分两个阶段进行： <ul><li>第一阶段在NVT系综下进行。nvt平衡目的是为了稳定系统的温度</li><li>第二阶段在NPT系综下进行。npt平衡目的是为了稳定系统的压力</li></ul></li><li>这里对重原子施加位置限制，grompp命令相比于前面多了一个 <code>-r</code>参数，表示为模拟的位置限制提供初始的参考结构。</li><li>位置约束的意义在于：允许平衡蛋白质周围的溶剂，而不会对蛋白质结构施加变化。</li><li>注意这里的动力学参数文件第一行 <code>define = -DPOSRES</code>，开启了位置限制，用到了前面pdb2gmx生成的位置限制文件。在这里可以找到 <a href="https://aiwting.github.io/1/nvt.mdp" target="_blank" rel="noreferrer">nvt.mdp</a> 文件。</li><li>进行时长100ps的平衡</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.tpr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx grompp, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.tpr</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> roughly</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 37</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Be less curious about people and more curious about ideas.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Marie </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Curie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 然后运行mdrun</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -deffnm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx mdrun, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -deffnm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;LYSOZYME in water&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">50000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> steps,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    100.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 14200:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 48</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 48</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 48,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.000:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 65.5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 14400:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 42,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.073:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 61.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 14600:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 36</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 36,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.252:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 187.5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 14800:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 40</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 40,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.127:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 102.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15000:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 42,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.073:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 95.6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15200:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 44</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 44</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 44,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.025:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 81.5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15400:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 48</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 48</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 48,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.000:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 76.6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M-cycles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              optimal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 42,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coulomb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutoff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.073</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 26700,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remaining</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 等待计算完成</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Writing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> final</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coordinates.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 50000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remaining</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               Core</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (s)   Wall t (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)        (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       Time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      121.848</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       20.310</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      599.9</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                 (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ns/day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hour/ns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Performance:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      425.410</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0.056</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Alas, You&#39;re Welcome&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Prof. </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Dumbledore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Potter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Puppet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>再次使用energy来分析温度的变化：在提示符处键入“16 0”以选择系统的温度并退出。</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.edr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temperature.xvg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx energy, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.edr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temperature.xvg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Opened</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.edr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> single</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> precision</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> terms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> want</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">selecting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> either</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (part </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) the name or the number or a combination.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">End</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> selection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> an</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> empty</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zero.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Bond</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">             2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Angle</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Proper-Dih.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Per.-Imp.-Dih.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  LJ-14</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Coulomb-14</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  LJ-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Disper.-corr.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Coulomb-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Coul.-recip.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Position-Rest.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Potential</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Kinetic-En.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     14</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Total-Energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Conserved-En.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Temperature</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 17</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres.-DC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pressure</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        19</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Constr.-rmsd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-XX</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-XY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-XZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          23</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-YX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-YY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-YZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-ZX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-ZY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Vir-ZZ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-XX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-XY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         31</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-XZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         32</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-YX</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 33</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-YY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         34</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-YZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         35</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-ZX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-ZY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 37</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Pres-ZZ</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                             38</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  #Surf*SurfTen</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  T-Protein</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                           40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  T-Water_and_ions</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Lamb-Protein</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                        42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Lamb-Water_and_ions</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Last</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frame</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> read</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  100.000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Statistics</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> over</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> through</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100.0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ],</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sets</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">All</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> statistics</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> over</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 501</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> points</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Energy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      Average</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Err.Est.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RMSD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Tot-Drift</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Temperature</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                 300.134</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    3.27203</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0.620947</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (K)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;You are wrong!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (NOFX)</span></span></code></pre></div><ul><li>输入<code>xmgrace temperature.xvg</code>查看温度变化，生成的图应如下：从图中可以看出系统的温度迅速达到目标值（300 K）附近。</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-2.png" width="60%" align="center"></p><p><em>系统的温度变化</em> :::</p><h2 id="步骤7-npt平衡" tabindex="-1">步骤7-NPT平衡 <a class="header-anchor" href="#步骤7-npt平衡" aria-label="Permalink to &quot;步骤7-NPT平衡&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp, mdrun, energy</p></blockquote><ul><li>过程几乎与nvt平衡类似，进行100ps，开启位置限制。</li><li>这里可以找到 <a href="https://aiwting.github.io/1/npt.mdp" target="_blank" rel="noreferrer">npt.mdp</a> 文件，注意mdp文件中的一些变化 <ul><li><code>continuation = yes</code>表示从NVT平衡阶段继续模拟</li><li><code>gen_vel = no</code>表示从轨迹中读取速度</li></ul></li><li><code>-t</code>指定上一步生成的检查点文件.cpt，存储了上一步模拟过程中的完整状态信息。配合上述mdp文件的参数使用。</li><li>这里可能会出现一个警告warning，在最新版本的GROMACS中会出现，不用管它，这是官方在推荐使用一种新的恒压方法。在命令最后添加 <code>-maxwarn 1</code>重新运行。</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.cpt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.tpr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WARNING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [file </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">npt.mdp]:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Berendsen</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> barostat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> strictly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> correct</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ensemble,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> should</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> used</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> production</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simulations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (in </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">our</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> opinion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  We</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> recommend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C-rescale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> barostat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instead.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> was</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WARNING</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Program:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2024.3-conda_forge</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/gromacs/gmxpreprocess/grompp.cpp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (line </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2751</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Fatal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Too</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> many</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> warnings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (1).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">If</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sure</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> warnings</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> harmless,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -maxwarn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> option.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">For</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> more</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> information</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tips</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> troubleshooting,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GROMACS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">website</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://manual.gromacs.org/current/user-guide/run-time-errors.html</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> warning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 忽略它重新运行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nvt.cpt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -maxwarn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 然后运行mdrun</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -deffnm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span></code></pre></div><ul><li>再次使用energy来分析压强、密度的变化：</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.edr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pressure.xvg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> energy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.edr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> density.xvg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 24</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span></code></pre></div><ul><li>再次执行绘图命令 <code>xmgrace pressure.xvg</code>，<code>xmgrace density.xvg</code>，压力和密度均很快达到平衡，表明系统现在在压力和密度方面平衡良好。</li><li>压力值在平衡阶段的过程中波动很大，但不用担心，压力是一个在MD模拟过程中波动很大的量。</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-3.png" width="60%" align="center"></p><p><em>系统的压力变化</em> :::</p><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-4.png" width="60%" align="center"></p><p><em>系统的密度变化</em> :::</p><h2 id="步骤8-md模拟" tabindex="-1">步骤8-MD模拟 <a class="header-anchor" href="#步骤8-md模拟" aria-label="Permalink to &quot;步骤8-MD模拟&quot;">​</a></h2><ul><li>在完成两个平衡阶段后，系统现在在所需的温度和压力下充分平衡。</li><li>操作流程几乎类似npt平衡，区别在于关闭位置限制，因此不需要 <code>-r</code>参数；继续从上一个模拟过程开始，因此 <code>-t</code>指定上一个过程生成的cpt文件。</li><li>动力学模拟的参数文件可以在这里找到 <a href="https://aiwting.github.io/1/md.mdp" target="_blank" rel="noreferrer">md.mdp</a></li><li>同样使用 <code>-maxwarn 1</code>忽略压力平衡器的警告</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.cpt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -maxwarn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx grompp, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Executable:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Working</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /mnt/e/share/teach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grompp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md.mdp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.gro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npt.cpt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1aki.top</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -maxwarn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WARNING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [file </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">md.mdp]:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  13397</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> atoms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> center</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mass</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> motion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> removal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> may</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lead</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> artifacts.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  In</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> most</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cases</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> one</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> should</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> one</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> whole</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> was</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WARNING</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Is That a Real Poncho ?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (F. </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Zappa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 然后执行MD模拟，花费时间因机器性能而异（几分钟~1个多小时）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mdrun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -deffnm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) GROMACS - gmx mdrun, 2024.3-conda_forge (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 499900,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remaining</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Writing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> final</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coordinates.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">step</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 500000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remaining</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               Core</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (s)   Wall t (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)        (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       Time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      830.063</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      138.346</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      600.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                 (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ns/day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hour/ns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Performance:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      624.522</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0.038</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GROMACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reminds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Developer accused of unreadable code refuses to comment&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Molly </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Struve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>恭喜你完成了一个完整的GROMACS模拟案例! 接下来是简单的分析.</strong></p><h2 id="模拟后处理与分析" tabindex="-1">模拟后处理与分析 <a class="header-anchor" href="#模拟后处理与分析" aria-label="Permalink to &quot;模拟后处理与分析&quot;">​</a></h2><h3 id="观察运动轨迹" tabindex="-1">观察运动轨迹 <a class="header-anchor" href="#观察运动轨迹" aria-label="Permalink to &quot;观察运动轨迹&quot;">​</a></h3><ul><li>用VMD查看模拟轨迹，可以发现溶菌酶分子在水中的运动情况。</li><li>由于执行MD模拟时开启了去除蛋白质的质心平移(在 md.mdp 文件中: &quot;comm-grps = Protein&quot;), 溶菌酶分子几乎在盒子中心旋转而不会越出盒子边界.</li></ul><p>:::{figure-md} <img src="http://101.201.29.162:8899/i/2025/07/17/x8evx5-0.gif" width="90%" align="center"></p><p><em>溶菌酶在水中的模拟轨迹图</em> :::</p><h3 id="轨迹文件处理" tabindex="-1">轨迹文件处理 <a class="header-anchor" href="#轨迹文件处理" aria-label="Permalink to &quot;轨迹文件处理&quot;">​</a></h3><blockquote><p>GROMACS工具：trjconv</p></blockquote><ul><li>如果你的目标分子跑出盒子处于盒子边界处（这里不会因为mdp文件中设置消除了蛋白质的质心运动），需要 <code>trjconv</code>来调整轨迹文件位置。</li><li>本案例可以不执行.</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> trjconv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.xtc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0_noPBC.xtc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pbc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mol</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -center</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选择1（“Protein”）作为要居中的组，选择0（“System”）作为输出。</span></span></code></pre></div><ul><li>此外 <code>trjconv</code>还可以转换轨迹文件格式，调整轨迹步数间隔，输出某一段的轨迹文件、输出某些步的结构文件等等。</li></ul><h3 id="计算根均方偏差rmsd" tabindex="-1">计算根均方偏差RMSD <a class="header-anchor" href="#计算根均方偏差rmsd" aria-label="Permalink to &quot;计算根均方偏差RMSD&quot;">​</a></h3><blockquote><p>GROMACS工具：rms</p></blockquote><ul><li>蛋白质的RMSD反映了模拟的收敛性和蛋白的稳定性.</li><li><code>rms</code> 计算模拟过程中的结构与初始结构的RMSD，程序会对结构进行最小二乘拟合并给出RMSD随时间的变化，将得到一个xvg文件，包含了RMSD随时间的变化。</li><li><code>-tu</code>表示设置输出时间单位, 这里设置为 ns</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 以经过两步平衡后的结构为参考结构</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rms</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.xtc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rmsd.xvg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选择3（“α碳”），两次选择相同的组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 再与晶体结构作为参考结构做一下对比</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rms</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> em.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.xtc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rmsd_crystal.xvg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 然后用xmgrace绘图</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmgrace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rmsd.xvg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rmsd_crystal.xvg</span></span></code></pre></div><ul><li>结果看起来像这样：</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-6.png" width="90%" align="center"></p><p><em>溶菌酶α碳的RMSD</em> :::</p><ul><li>可以看到RMSD很快稳定到一个较小的值，并在后续保持。这说明溶菌酶分子在水中结构非常稳定波动很小，且该模拟很容易达到平衡，与该晶体结构略有细微差异。</li></ul><h3 id="蛋白质回旋半径" tabindex="-1">蛋白质回旋半径 <a class="header-anchor" href="#蛋白质回旋半径" aria-label="Permalink to &quot;蛋白质回旋半径&quot;">​</a></h3><blockquote><p>GROMACS工具：gyrate</p></blockquote><ul><li>蛋白质的回转半径是其致密性的衡量标准：回旋半径取决于某(些)原子质量与分子重心的关系, 因此可用于表征蛋白质结构的密实度。</li><li>如果一个蛋白质是稳定折叠态，它将可能保持相对稳定的Rg值。如果一个蛋白质展开，它的Rg会随着时间的推移而改变。</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gyrate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.xtc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gyrate.xvg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选择第1组（“Protein”）进行分析</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 绘图</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmgrace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gyrate.xvg</span></span></code></pre></div><ul><li>从平稳的Rg值看出，溶菌酶在300 K 下 1 ns 的过程中保持非常稳定的折叠状态：</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-7.png" width="80%" align="center"></p><p><em>溶菌酶分子的回旋半径</em> :::</p><p><strong>至此，我们完成了水中溶菌酶的全部模拟并进行了简单的分析！你应该熟悉了GROMACS的基本模拟流程，一些常用的GROMACS工具（模块）及其命令。</strong></p>`,54))])}const b=p(r,[["render",E]]);export{Q as __pageData,b as default};
