<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>入门案例1 | Molecular Simulation</title>
    <meta name="description" content="Understand molecular simulation">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.DyuDdfoM.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DkKcM6s_.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.CUm38EsZ.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Bw-5EFTY.js">
    <link rel="modulepreload" href="/assets/分子模拟_快速入门_入门案例1.md.DWgG6Gxr.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>Molecular Simulation</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/README.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>分子模拟</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/Contact.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>联系我</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/aiwting/" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/aiwting/" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><!----><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/Contact.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Contact</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/README.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>README</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>必备技能</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/Amber%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Amber概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/Cellulose-Builder.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Cellulose-Builder</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/Conda%E5%85%A5%E9%97%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Conda入门</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/GLYCAM%E5%8A%9B%E5%9C%BA%E4%BB%8B%E7%BB%8D.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>GLYCAM力场介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/GROMACS%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>GROMACS概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/VScode%E5%85%A5%E9%97%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>VScode入门</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>快速入门</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B1.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>入门案例1</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/%E5%AE%89%E8%A3%85GROMACS.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>安装GROMACS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/%E5%AE%89%E8%A3%85Linux.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>安装Linux</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>案例复现</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E6%A1%88%E4%BE%8B%E5%A4%8D%E7%8E%B0/%E7%BA%A4%E7%BB%B4%E7%B4%A0-%E8%81%9A%E4%B8%99%E7%83%AF%E5%A4%8D%E5%90%88%E6%9D%90%E6%96%99.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>纤维素-聚丙烯复合材料</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>背景知识</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%88%86%E5%AD%90%E5%8A%9B%E5%AD%A6%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>分子力学概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>分子动力学概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%88%86%E5%AD%90%E5%AF%B9%E6%8E%A5%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>分子对接概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%88%86%E5%AD%90%E5%BB%BA%E6%A8%A1.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>分子建模</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>分子模拟概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%9B%BD%E5%86%85%E5%A4%96%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>国内外研究进展</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%A8%A1%E6%8B%9F%E8%BE%BE%E5%88%B0%E5%B9%B3%E8%A1%A1.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>如何判断模拟达到平衡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E6%A8%A1%E6%8B%9F%E5%8F%82%E6%95%B0%E7%9A%84%E8%AE%BE%E7%BD%AE.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>模拟参数的设置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>模拟退火</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8%E5%8A%9B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>相互作用力</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E7%B2%97%E7%B2%92%E5%8C%96%E6%A8%A1%E6%8B%9F.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>粗粒化模拟</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E7%BB%9F%E8%AE%A1%E5%8A%9B%E5%AD%A6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>统计力学</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E8%87%AA%E7%94%B1%E8%83%BD%E8%AE%A1%E7%AE%97.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>自由能计算</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>蒙特卡洛</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E8%9B%8B%E7%99%BD%E8%B4%A8%E4%BA%8C%E7%BA%A7%E7%BB%93%E6%9E%84.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>蛋白质二级结构</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E9%87%8F%E5%AD%90%E5%8C%96%E5%AD%A6%E6%A6%82%E8%BF%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>量子化学概述</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86/%E9%9D%99%E7%94%B5%E8%AE%A1%E7%AE%97.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>静电计算</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>目录</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F_%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8_%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B1" data-v-e6f2a212><div><h1 id="入门案例1" tabindex="-1">入门案例1 <a class="header-anchor" href="#入门案例1" aria-label="Permalink to &quot;入门案例1&quot;">​</a></h1><p>新手的第一个GROMACS案例——<strong>水中的溶菌酶</strong></p><ul><li>该教程来自弗吉尼亚理工大学生物化学系的分子动力学教程：www.mdtutorials.com</li><li>该模拟流程完整清晰，符合一个GROMACS模拟的标准流程，足够简单不需要复杂的准备工作，<strong>是了解GROMACS基本操作的入门案例</strong>.</li><li>此案例将模拟一个包含一个溶菌酶分子的简单的水系统，通过此案例，将实际了解GROMACS执行MD的具体流程，基本命令操作.</li></ul><h2 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h2><h3 id="环境及软件准备" tabindex="-1">环境及软件准备 <a class="header-anchor" href="#环境及软件准备" aria-label="Permalink to &quot;环境及软件准备&quot;">​</a></h3><p>如果你按照上一小节的教程安装了 <em>GROMACS及额外的模拟软件</em>, 里面包含了本节需要的可视化工具 VMD.</p><ul><li>首先需要 <em>安装GROMACS</em>，这里默认你使用的是Windows版或者是WSL中的GROMACS</li><li>VMD 工具用来可视化分子结构和模拟轨迹</li><li>Grace 用来将xvg文件绘制成图表 <ul><li>因为grace的版本不同, 调用grace的命令可能是: <code>xmgrace</code>, <code>qtgrace</code>, <code>grace</code></li><li>如果还没有安装grace绘图程序，且你正在使用的是ubuntu系统，可以使用<code>sudo atp-get install grace</code>命令安装。</li></ul></li></ul><h3 id="gromacs初识" tabindex="-1">GROMACS初识 <a class="header-anchor" href="#gromacs初识" aria-label="Permalink to &quot;GROMACS初识&quot;">​</a></h3><ul><li>GROMACS的所有工具都是以命令形式调用，所以需要在命令行界面操作。命令格式形如：<code>gmx &lt;module&gt; &lt;parameters&gt;</code><ul><li>module 是各种GROMACS工具，可以完成生成拓扑参数、构建盒子、添加溶剂、添加离子、执行模拟计算等功能.</li><li>parameters 规定了一条GROMACS命令具体的输入与输出文件，以及一些可选项.</li><li>例如，想要查询一个GROMACS工具可以接受的参数，使用 <code>gmx &lt;module&gt; -h</code>，输出依次是： <ul><li>程序在电脑中的路径</li><li>GROMACS的安装路径</li><li>当前的工作目录</li><li>输入的命令</li><li>该工具的语法、描述、可选项、其它选项、</li><li>最后是GROMACS程序的提示语（提示语没用，但看到它表示此次命令执行成功）。</li></ul></li></ul></li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx pdb2gmx -h</span></span>
<span class="line"><span>               :-) GROMACS - gmx pdb2gmx, 2024.3-conda_forge (-:</span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/ms</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx pdb2gmx -h</span></span>
<span class="line"><span></span></span>
<span class="line"><span>SYNOPSIS</span></span>
<span class="line"><span>gmx pdb2gmx [-f [&lt;.gro/.g96/...&gt;]] [-o [&lt;.gro/.g96/...&gt;]] [-p [&lt;.top&gt;]]</span></span>
<span class="line"><span>            [-i [&lt;.itp&gt;]] [-n [&lt;.ndx&gt;]] [-q [&lt;.gro/.g96/...&gt;]]</span></span>
<span class="line"><span>            [-chainsep &lt;enum&gt;] [-merge &lt;enum&gt;] [-ff &lt;string&gt;] [-water &lt;enum&gt;]</span></span>
<span class="line"><span>            [-[no]inter] [-[no]ss] [-[no]ter] [-[no]lys] [-[no]arg]</span></span>
<span class="line"><span>            [-[no]asp] [-[no]glu] [-[no]gln] [-[no]his] [-angle &lt;real&gt;]</span></span>
<span class="line"><span>            [-dist &lt;real&gt;] [-[no]una] [-[no]ignh] [-[no]missing] [-[no]v]</span></span>
<span class="line"><span>            [-posrefc &lt;real&gt;] [-vsite &lt;enum&gt;] [-[no]heavyh] [-[no]deuterate]</span></span>
<span class="line"><span>            [-[no]chargegrp] [-[no]cmap] [-[no]renum] [-[no]rtpres]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DESCRIPTION</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>OPTIONS</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>Other options:</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>GROMACS reminds you: &quot;If we knew what it was we were doing, it would not be called research, would it?&quot; (Albert Einstein)</span></span></code></pre></div><h3 id="文件准备" tabindex="-1">文件准备 <a class="header-anchor" href="#文件准备" aria-label="Permalink to &quot;文件准备&quot;">​</a></h3><ul><li>获得蛋白质结构文件，去<a href="https://www.rcsb.org/" target="_blank" rel="noreferrer">RCSB</a>网站下载溶菌酶的pdb文件，通过 PDB ID 搜索 &quot;1AKI&quot; &gt;点击右侧“Download Files” &gt;&quot;Legacy PDB Format&quot;，将得到&quot;1aki.pdb&quot;文件.</li><li>打开 &quot;1aki.pdb&quot; 文件，可以看到其中包含了结晶水&quot;HOH&quot;，删除所有&quot;HOH&quot;所在行，命名为&quot;1aki-h2o.pdb&quot;, 使用Linux命令实现: <code>grep -v HOH 1aki.pdb &gt; 1aki-h2o.pdb</code></li><li>注意检查蛋白质pdb文件结构，一个标准的蛋白质pdb文件包含了： <ul><li>文件标题 HEADER</li><li>实验数据和元数据 REMARK</li><li>残基序列 SEQRES</li><li>二级和三级结构信息 HELIX SHEET</li><li>晶体学信息 CRYST1</li><li>二硫键 SSBOND</li><li>原子坐标 ATOM</li><li>非标准残基或配体的原子 HETATM</li><li>原子之间的连接关系 CONECT</li><li>TER 用于标识链的结束</li><li>MODEL 用于多模型结构的描述等等.</li></ul></li></ul><p><!---->: <a href="https://pan.baidu.com/s/1eglrcdUy_04_14xQWatAmw?pwd=994j" target="_blank" rel="noreferrer">百度网盘下载</a></p><h2 id="步骤1-生成拓扑结构" tabindex="-1">步骤1-生成拓扑结构 <a class="header-anchor" href="#步骤1-生成拓扑结构" aria-label="Permalink to &quot;步骤1-生成拓扑结构&quot;">​</a></h2><blockquote><p>GROMACS工具：pdb2gmx</p></blockquote><ul><li>pdb2gmx命令会生成三个文件： <ol><li>分子的拓扑结构.top</li><li>位置限制文件.itp</li><li>GROMACS格式的结构文件.gro</li></ol></li><li>需要输入数字来选择力场和水模型，相关信息将写入top文件中。力场选择&quot;AMBER99SB&quot;，水模型无特殊需求选择简单点电荷水即可&quot;TIP3P&quot;</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx pdb2gmx -f 1aki-h2o.pdb -p 1aki.top -i 1aki.itp -o 1aki.gro</span></span>
<span class="line"><span>               :-) GROMACS - gmx pdb2gmx, 2024.3-conda_forge (-:</span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx pdb2gmx -f 1aki-h2o.pdb -p 1aki.top -i 1aki.itp -o 1aki.gro</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Select the Force Field:</span></span>
<span class="line"><span>From &#39;/home/zz/miniconda3/envs/md/share/gromacs/top&#39;:</span></span>
<span class="line"><span> 1: AMBER03 protein, nucleic AMBER94 (Duan et al., J. Comp. Chem. 24, 1999-2012, 2003)</span></span>
<span class="line"><span> 2: AMBER94 force field (Cornell et al., JACS 117, 5179-5197, 1995)</span></span>
<span class="line"><span> 3: AMBER96 protein, nucleic AMBER94 (Kollman et al., Acc. Chem. Res. 29, 461-469, 1996)</span></span>
<span class="line"><span> 4: AMBER99 protein, nucleic AMBER94 (Wang et al., J. Comp. Chem. 21, 1049-1074, 2000)</span></span>
<span class="line"><span> 5: AMBER99SB protein, nucleic AMBER94 (Hornak et al., Proteins 65, 712-725, 2006)</span></span>
<span class="line"><span> 6: AMBER99SB-ILDN protein, nucleic AMBER94 (Lindorff-Larsen et al., Proteins 78, 1950-58, 2010)</span></span>
<span class="line"><span> 7: AMBERGS force field (Garcia &amp; Sanbonmatsu, PNAS 99, 2782-2787, 2002)</span></span>
<span class="line"><span> 8: CHARMM27 all-atom force field (CHARM22 plus CMAP for proteins)</span></span>
<span class="line"><span> 9: GROMOS96 43a1 force field</span></span>
<span class="line"><span>10: GROMOS96 43a2 force field (improved alkane dihedrals)</span></span>
<span class="line"><span>11: GROMOS96 45a3 force field (Schuler JCC 2001 22 1205)</span></span>
<span class="line"><span>12: GROMOS96 53a5 force field (JCC 2004 vol 25 pag 1656)</span></span>
<span class="line"><span>13: GROMOS96 53a6 force field (JCC 2004 vol 25 pag 1656)</span></span>
<span class="line"><span>14: GROMOS96 54a7 force field (Eur. Biophys. J. (2011), 40,, 843-856, DOI: 10.1007/s00249-011-0700-9)</span></span>
<span class="line"><span>15: OPLS-AA/L all-atom force field (2001 aminoacid dihedrals)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>$ 5</span></span>
<span class="line"><span>Using the Amber99sb force field in directory amber99sb.ff</span></span>
<span class="line"><span>Opening force field file /home/zz/miniconda3/envs/md/share/gromacs/top/amber99sb.ff/watermodels.dat</span></span>
<span class="line"><span>Select the Water Model:</span></span>
<span class="line"><span> 1: TIP3P     TIP 3-point, recommended</span></span>
<span class="line"><span> 2: TIP4P     TIP 4-point</span></span>
<span class="line"><span> 3: TIP4P-Ew  TIP 4-point optimized with Ewald, recommended</span></span>
<span class="line"><span> 4: TIP5P     TIP 5-point (see https://gitlab.com/gromacs/gromacs/-/issues/1348 for issues)</span></span>
<span class="line"><span> 5: SPC       simple point charge</span></span>
<span class="line"><span> 6: SPC/E     extended simple point charge</span></span>
<span class="line"><span> 7: None</span></span>
<span class="line"><span></span></span>
<span class="line"><span>$ 1</span></span>
<span class="line"><span>going to rename amber99sb.ff/aminoacids.r2b</span></span>
<span class="line"><span>Opening force field file /home/zz/miniconda3/envs/md/share/gromacs/top/amber99sb.ff/aminoacids.r2b</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Analyzing pdb file</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Total mass 14313.332 a.m.u.</span></span>
<span class="line"><span>Total charge 8.000 e</span></span>
<span class="line"><span>Writing topology</span></span>
<span class="line"><span>Writing coordinate file...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                --------- PLEASE NOTE ------------</span></span>
<span class="line"><span>You have successfully generated a topology from: 1aki-h2o.pdb.</span></span>
<span class="line"><span>The Amber99sb force field and the tip3p water model are used.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                --------- ETON ESAELP ------------</span></span>
<span class="line"><span>GROMACS reminds you: &quot;The Carpenter Goes Bang Bang&quot; (The Breeders)</span></span></code></pre></div><ul><li>现在使用VMD观察 1aki.gro 文件, 先输入命令<code>vmd 1aki.gro</code>打开VMD, 然后在命令窗口输入 <code>pbc box</code>回车, 会发现蛋白质没有完全在盒子内, 接下来进行调整.</li></ul><h2 id="步骤2-调整模拟盒子" tabindex="-1">步骤2-调整模拟盒子 <a class="header-anchor" href="#步骤2-调整模拟盒子" aria-label="Permalink to &quot;步骤2-调整模拟盒子&quot;">​</a></h2><blockquote><p>GROMACS工具：editconf</p></blockquote><ul><li>使用简单的立方体作为盒子，将蛋白质剧中，距离边界至少0.2nm</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx editconf -f 1aki.gro -o 1aki_newbox.gro -bt cubic -c -d 0.2</span></span>
<span class="line"><span>               :-) GROMACS - gmx editconf, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx editconf -f 1aki.gro -o 1aki_newbox.gro -bt cubic -c -d 0.2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Note that major changes are planned in future for editconf, to improve usability and utility.</span></span>
<span class="line"><span>Read 1960 atoms</span></span>
<span class="line"><span>Volume: 123.376 nm^3, corresponds to roughly 55500 electrons</span></span>
<span class="line"><span>No velocities found</span></span>
<span class="line"><span>    system size :  3.817  4.234  3.454 (nm)</span></span>
<span class="line"><span>    diameter    :  5.010               (nm)</span></span>
<span class="line"><span>    center      :  2.781  2.488  0.017 (nm)</span></span>
<span class="line"><span>    box vectors :  5.906  6.845  3.052 (nm)</span></span>
<span class="line"><span>    box angles  :  90.00  90.00  90.00 (degrees)</span></span>
<span class="line"><span>    box volume  : 123.38               (nm^3)</span></span>
<span class="line"><span>    shift       : -0.076  0.217  2.688 (nm)</span></span>
<span class="line"><span>new center      :  2.705  2.705  2.705 (nm)</span></span>
<span class="line"><span>new box vectors :  5.410  5.410  5.410 (nm)</span></span>
<span class="line"><span>new box angles  :  90.00  90.00  90.00 (degrees)</span></span>
<span class="line"><span>new box volume  : 158.35               (nm^3)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Back Off! I just backed up 1aki_newbox.gro to ./#1aki_newbox.gro.1#</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;Predictions can be very difficult - especially about the future.&quot; (Niels Bohr)</span></span></code></pre></div><ul><li>再次使用VMD观察&quot;1aki_newbox.gro&quot;，可以看到盒子蛋白质已经位于盒子中央.</li></ul><h2 id="步骤3-添加溶剂-溶剂化蛋白质" tabindex="-1">步骤3-添加溶剂(溶剂化蛋白质) <a class="header-anchor" href="#步骤3-添加溶剂-溶剂化蛋白质" aria-label="Permalink to &quot;步骤3-添加溶剂(溶剂化蛋白质)&quot;">​</a></h2><blockquote><p>GROMACS工具：solvate</p></blockquote><ul><li>使用水模型 <code>spc216.gro</code>（这是一个通用的三点水模型）填充盒子，并指定更新top文件（因为引入了新的分子，每次向盒子中添加新分子都需要更新top文件）</li><li>注意这里重复使用了&quot;1aki.top&quot;文件名，因此原来的文件将被备份为&quot;#1aki.top.1#&quot;</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx solvate -cp 1aki_newbox.gro -cs spc216.gro -o 1aki_solvate.gro -p 1aki.top</span></span>
<span class="line"><span>               :-) GROMACS - gmx solvate, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx solvate -cp 1aki_newbox.gro -cs spc216.gro -o 1aki_solvate.gro -p 1aki.top</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Reading solute configuration</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Generating solvent configuration</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Output configuration contains 15373 atoms in 4600 residues</span></span>
<span class="line"><span>Volume                 :     158.347 (nm^3)</span></span>
<span class="line"><span>Density                :     1004.79 (g/l)</span></span>
<span class="line"><span>Number of solvent molecules:   4471</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Processing topology</span></span>
<span class="line"><span>Adding line for 4471 solvent molecules with resname (SOL) to topology file (1aki.top)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Back Off! I just backed up 1aki.top to ./#1aki.top.1#</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;I wanted to have a real language where programmers could write real programs, and see whether they would find the idea of data abstraction at </span></span>
<span class="line"><span>all useful.&quot; (Barbara Liskov)</span></span></code></pre></div><ul><li>重新观察一下新的&quot;1aki.top&quot;文件，最下面将多一行&quot;SOL 4471&quot;表示4471个溶剂分子</li></ul><div class="language-1aki.top vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">1aki.top</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[ molecules ]</span></span>
<span class="line"><span>; Compound        #mols</span></span>
<span class="line"><span>Protein_chain_A     1</span></span>
<span class="line"><span>SOL              4471</span></span></code></pre></div><ul><li>可以用VMD查看一下新的结构文件&quot;1aki_solvate.gro&quot;，可以看到水分子充满了盒子，溶菌酶被包裹在中间。</li></ul><h2 id="步骤4-添加离子" tabindex="-1">步骤4-添加离子 <a class="header-anchor" href="#步骤4-添加离子" aria-label="Permalink to &quot;步骤4-添加离子&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp和genion</p></blockquote><ul><li>如果你注意pdb2gmx命令的输出，可以看到溶菌酶的净电荷为+8e ：&quot;Total charge 8.000 e&quot;，因此需要添加离子中和。</li><li>genion工具需要读取扩展名为.tpr的文件，因此首先用grompp工具先生成tpr文件</li><li>要使用grompp生成一个.tpr文件，还需要一个扩展名为.mdp的文件，可以在此处下载示例 <a href="https://aiwting.github.io/1/ions.mdp" target="_blank" rel="noreferrer">ions.mdp</a> 文件</li><li>grompp将动力学参数、结构信息、拓扑参数三部分信息整理成二进制的tpr文件。</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx grompp -f ions.mdp -c 1aki_solvate.gro -p 1aki.top -o ions.tpr</span></span>
<span class="line"><span>                :-) GROMACS - gmx grompp, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx grompp -f ions.mdp -c 1aki_solvate.gro -p 1aki.top -o ions.tpr</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Setting the LD random seed to 1608515534</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>NOTE 1 [file 1aki.top, line 18409]:</span></span>
<span class="line"><span>  System has non-zero total charge: 8.000000</span></span>
<span class="line"><span>  Total charge should normally be an integer. See</span></span>
<span class="line"><span>  https://manual.gromacs.org/current/user-guide/floating-point.html</span></span>
<span class="line"><span>  for discussion on how close it should be to an integer.</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Analysing residue names:</span></span>
<span class="line"><span>There are:   129    Protein residues</span></span>
<span class="line"><span>There are:  4471      Water residues</span></span>
<span class="line"><span>Analysing Protein...</span></span>
<span class="line"><span>Number of degrees of freedom in T-Coupling group rest is 32703.00</span></span>
<span class="line"><span>The integrator does not provide a ensemble temperature, there is no system ensemble temperature</span></span>
<span class="line"><span></span></span>
<span class="line"><span>NOTE 2 [file ions.mdp]:</span></span>
<span class="line"><span>  You are using a plain Coulomb cut-off, which might produce artifacts.</span></span>
<span class="line"><span>  You might want to consider using PME electrostatics.</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>This run will generate roughly 1 Mb of data</span></span>
<span class="line"><span></span></span>
<span class="line"><span>There were 2 NOTEs</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;The future always gets twisted and turned&quot; (Lisa o Piu)</span></span></code></pre></div><ul><li>接下来正式添加离子，指定阳离子为钠离子，阴离子为氯离子，使体系保持电中性 &quot;-neutral&quot;，并更新top文件.</li><li>过程中需要输入溶剂组&quot;SOL&quot;对应的数字.</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx genion -s ions.tpr -o 1aki_solvate_ions.gro -pname NA -nname CL -neutral -p 1aki.top</span></span>
<span class="line"><span>                :-) GROMACS - gmx genion, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx genion -s ions.tpr -o 1aki_solvate_ions.gro -pname NA -nname CL -neutral -p 1aki.top</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Reading file ions.tpr, VERSION 2024.3-conda_forge (single precision)</span></span>
<span class="line"><span>Reading file ions.tpr, VERSION 2024.3-conda_forge (single precision)</span></span>
<span class="line"><span>Will try to add 0 NA ions and 8 CL ions.</span></span>
<span class="line"><span>Select a continuous group of solvent molecules</span></span>
<span class="line"><span>Group     0 (         System) has 15373 elements</span></span>
<span class="line"><span>Group     1 (        Protein) has  1960 elements</span></span>
<span class="line"><span>Group     2 (      Protein-H) has  1001 elements</span></span>
<span class="line"><span>Group     3 (        C-alpha) has   129 elements</span></span>
<span class="line"><span>Group     4 (       Backbone) has   387 elements</span></span>
<span class="line"><span>Group     5 (      MainChain) has   517 elements</span></span>
<span class="line"><span>Group     6 (   MainChain+Cb) has   634 elements</span></span>
<span class="line"><span>Group     7 (    MainChain+H) has   646 elements</span></span>
<span class="line"><span>Group     8 (      SideChain) has  1314 elements</span></span>
<span class="line"><span>Group     9 (    SideChain-H) has   484 elements</span></span>
<span class="line"><span>Group    10 (    Prot-Masses) has  1960 elements</span></span>
<span class="line"><span>Group    11 (    non-Protein) has 13413 elements</span></span>
<span class="line"><span>Group    12 (          Water) has 13413 elements</span></span>
<span class="line"><span>Group    13 (            SOL) has 13413 elements</span></span>
<span class="line"><span>Group    14 (      non-Water) has  1960 elements</span></span>
<span class="line"><span>Select a group: </span></span>
<span class="line"><span>$ 13</span></span>
<span class="line"><span>Selected 13: &#39;SOL&#39;</span></span>
<span class="line"><span>Number of (3-atomic) solvent molecules: 4471</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Processing topology</span></span>
<span class="line"><span>Replacing 8 solute molecules in topology file (1aki.top)  by 0 NA and 8 CL ions.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Back Off! I just backed up 1aki.top to ./#1aki.top.2#</span></span>
<span class="line"><span>Using random seed -54592018.</span></span>
<span class="line"><span>Replacing solvent molecule 855 (atom 4525) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 232 (atom 2656) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 1855 (atom 7525) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 4162 (atom 14446) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 72 (atom 2176) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 3463 (atom 12349) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 4122 (atom 14326) with CL</span></span>
<span class="line"><span>Replacing solvent molecule 1838 (atom 7474) with CL</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;Torture numbers, and they&#39;ll confess to anything.&quot; (Greg Easterbrook)</span></span></code></pre></div><ul><li>现在检查一下新的top文件，最下面应该多了&quot;CL 8&quot;</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[ molecules ]</span></span>
<span class="line"><span>; Compound        #mols</span></span>
<span class="line"><span>Protein_chain_A     1</span></span>
<span class="line"><span>SOL         4463</span></span>
<span class="line"><span>CL               8</span></span></code></pre></div><h2 id="步骤5-能量最小化" tabindex="-1">步骤5-能量最小化 <a class="header-anchor" href="#步骤5-能量最小化" aria-label="Permalink to &quot;步骤5-能量最小化&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp, mdrun, energy</p></blockquote><ul><li>在开始动力学之前，必须确保系统没有空间冲突或不适当的几何形状（尤其是对于自行绘制的分子结构，你没有办法精确的控制没个键长、键角的数值），通过能量最小化（EM）的过程来使得分子结构合理化。</li><li>但凡设计到使用grompp生成tpr文件，都需要mdp动力学参数文件，可以使用这里的示例 <a href="https://aiwting.github.io/1/em.mdp" target="_blank" rel="noreferrer">em.mdp</a> 文件。</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx grompp -f em.mdp -c 1aki_solvate_ions.gro -p 1aki.top -o em.tpr</span></span>
<span class="line"><span>                :-) GROMACS - gmx grompp, 2024.3-conda_forge (-:</span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx grompp -f em.mdp -c 1aki_solvate_ions.gro -p 1aki.top -o em.tpr</span></span>
<span class="line"><span></span></span>
<span class="line"><span>NOTE 1 [file em.mdp]:</span></span>
<span class="line"><span>  With Verlet lists the optimal nstlist is &gt;= 10, with GPUs &gt;= 20. Note</span></span>
<span class="line"><span>  that with the Verlet scheme, nstlist has no effect on the accuracy of</span></span>
<span class="line"><span>  your simulation.</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>This run will generate roughly 1 Mb of data</span></span>
<span class="line"><span></span></span>
<span class="line"><span>There was 1 NOTE</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;Youth is wasted on the young&quot; (The Smashing Pumpkins)</span></span></code></pre></div><ul><li>然后执行能量最小化计算 <ul><li><code>-deffnm em</code> 简写方法，意思是让mdrun工具以em为名的tpr文件为输入，并使得使出的各种格式的文件以em名字命名。</li><li><code>-v</code> 表示在命令行中显示计算过程</li></ul></li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx mdrun -deffnm em -v</span></span>
<span class="line"><span>                :-) GROMACS - gmx mdrun, 2024.3-conda_forge (-:</span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx mdrun -deffnm em -v</span></span>
<span class="line"><span></span></span>
<span class="line"><span>The current CPU can measure timings more accurately than the code in</span></span>
<span class="line"><span>gmx mdrun was configured to use. This might affect your simulation</span></span>
<span class="line"><span>speed as accurate timings are needed for load-balancing.</span></span>
<span class="line"><span>Please consider rebuilding gmx mdrun with the GMX_USE_RDTSCP=ON CMake option.</span></span>
<span class="line"><span>Reading file em.tpr, VERSION 2024.3-conda_forge (single precision)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1 GPU selected for this run.</span></span>
<span class="line"><span>Mapping of GPU IDs to the 1 GPU task in the 1 rank on this node:</span></span>
<span class="line"><span>  PP:0</span></span>
<span class="line"><span>PP tasks will do (non-perturbed) short-ranged interactions on the GPU</span></span>
<span class="line"><span>PP task will update and constrain coordinates on the CPU</span></span>
<span class="line"><span>Using 1 MPI thread</span></span>
<span class="line"><span>Using 12 OpenMP threads </span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Steepest Descents:</span></span>
<span class="line"><span>   Tolerance (Fmax)   =  1.00000e+03</span></span>
<span class="line"><span>   Number of steps    =        50000</span></span>
<span class="line"><span>Step=    0, Dmax= 1.0e-02 nm, Epot= -9.63828e+04 Fmax= 1.83369e+05, atom= 252</span></span>
<span class="line"><span>Step=    1, Dmax= 1.0e-02 nm, Epot= -1.13756e+05 Fmax= 6.57749e+04, atom= 1367</span></span>
<span class="line"><span>Step=    2, Dmax= 1.2e-02 nm, Epot= -1.32426e+05 Fmax= 3.07926e+04, atom= 1367</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>writing lowest energy coordinates.</span></span>
<span class="line"><span>Steepest Descents converged to Fmax &lt; 1000 in 336 steps</span></span>
<span class="line"><span>Potential Energy  = -2.2477358e+05</span></span>
<span class="line"><span>Maximum force     =  9.9712384e+02 on atom 736</span></span>
<span class="line"><span>Norm of force     =  3.6471184e+01</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;First off, I&#39;d suggest printing out a copy of the GNU coding standards, and NOT read it. Burn them, it&#39;s a great symbolic gesture.&quot; (Linus Torvalds)</span></span></code></pre></div><ul><li>计算完成后将得到四个文件 <ol><li>em.log：日志文件</li><li>em.edr：二进制能量文件</li><li>em.trr：二进制轨迹文件</li><li>em.gro：能量最小化结构</li></ol></li><li>如何确定EM是否成功？ <ul><li>势能：Epot 应该是负的，对于水中的简单蛋白质应该在 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.186ex;" xmlns="http://www.w3.org/2000/svg" width="9.266ex" height="2.14ex" role="img" focusable="false" viewBox="0 -864 4095.6 946" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mo" transform="translate(1658.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(2659,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>5</mn></msup><mo>−</mo><msup><mn>10</mn><mn>6</mn></msup></math></mjx-assistive-mml></mjx-container> 的数量级上</li><li>最大力：Fmax 一般不大于 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.05ex;" xmlns="http://www.w3.org/2000/svg" width="21.971ex" height="1.937ex" role="img" focusable="false" viewBox="0 -833.9 9711.3 855.9" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2000,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2521,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3376.2,0)"><path data-c="B7" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(3876.4,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4754.4,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(5239.4,0)"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(331,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mo" transform="translate(6746.3,0)"><path data-c="B7" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(7246.6,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(7846.6,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(911,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1000</mn><mi>k</mi><mi>J</mi><mo>·</mo><mi>m</mi><mi>o</mi><msup><mi>l</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>·</mo><mi>n</mi><msup><mi>m</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container></li><li>由于本次、模拟个体系很简单，而且蛋白质来源于PDB数据库，本身是一个较合理的结构，在很快的几百步计算下就完成了优化。</li></ul></li><li>简单的看一下能量变化，em.edr文件包含GROMACS在EM期间收集的所有能量项，可以使用GROMACS energy 模块分析任何.edr文件： <ul><li>过程中需要键入 <code>10 0</code>，10表示选择Potential，0表示终止输入。将输出Epot的平均值，以及一个名为“potential.xvg”的文件。</li></ul></li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx energy -f em.edr -o potential.xvg</span></span>
<span class="line"><span>                :-) GROMACS - gmx energy, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx energy -f em.edr -o potential.xvg</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Opened em.edr as single precision energy file</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Select the terms you want from the following list by</span></span>
<span class="line"><span>selecting either (part of) the name or the number or a combination.</span></span>
<span class="line"><span>End your selection with an empty line or a zero.</span></span>
<span class="line"><span>-------------------------------------------------------------------</span></span>
<span class="line"><span>  1  Bond             2  Angle            3  Proper-Dih.      4  Per.-Imp.-Dih.</span></span>
<span class="line"><span>  5  LJ-14            6  Coulomb-14       7  LJ-(SR)          8  Coulomb-(SR)</span></span>
<span class="line"><span>  9  Coul.-recip.    10  Potential       11  Pressure        12  Vir-XX</span></span>
<span class="line"><span> 13  Vir-XY          14  Vir-XZ          15  Vir-YX          16  Vir-YY</span></span>
<span class="line"><span> 17  Vir-YZ          18  Vir-ZX          19  Vir-ZY          20  Vir-ZZ</span></span>
<span class="line"><span> 21  Pres-XX         22  Pres-XY         23  Pres-XZ         24  Pres-YX</span></span>
<span class="line"><span> 25  Pres-YY         26  Pres-YZ         27  Pres-ZX         28  Pres-ZY</span></span>
<span class="line"><span> 29  Pres-ZZ         30  #Surf*SurfTen   31  T-rest</span></span>
<span class="line"><span></span></span>
<span class="line"><span>$ 10 0</span></span>
<span class="line"><span>Last energy frame read 265 time  335.000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Statistics over 336 steps [ 0.0000 through 335.0000 ps ], 1 data sets</span></span>
<span class="line"><span>All statistics are over 266 points (frames)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Energy                      Average   Err.Est.       RMSD  Tot-Drift</span></span>
<span class="line"><span>-------------------------------------------------------------------------------</span></span>
<span class="line"><span>Potential                   -213378       5900    15542.1   -39018.4  (kJ/mol)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;This Puke Stinks Like Beer&quot; (LIVE)</span></span></code></pre></div><ul><li>然后使用绘图工具可以绘制能量变化曲线，例如使用xmgrace程序，命令行输入 <code>xmgrace potential.xvg</code>，结果图应该看起来像如下图：展示了Epot的良好稳定收敛。</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-1.png" width="60%" align="center"></p><p><em>系统的总能量变化</em> :::</p><h2 id="步骤6-nvt平衡" tabindex="-1">步骤6-NVT平衡 <a class="header-anchor" href="#步骤6-nvt平衡" aria-label="Permalink to &quot;步骤6-NVT平衡&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp, mdrun, energy</p></blockquote><ul><li>平衡通常分两个阶段进行： <ul><li>第一阶段在NVT系综下进行。nvt平衡目的是为了稳定系统的温度</li><li>第二阶段在NPT系综下进行。npt平衡目的是为了稳定系统的压力</li></ul></li><li>这里对重原子施加位置限制，grompp命令相比于前面多了一个 <code>-r</code>参数，表示为模拟的位置限制提供初始的参考结构。</li><li>位置约束的意义在于：允许平衡蛋白质周围的溶剂，而不会对蛋白质结构施加变化。</li><li>注意这里的动力学参数文件第一行 <code>define = -DPOSRES</code>，开启了位置限制，用到了前面pdb2gmx生成的位置限制文件。在这里可以找到 <a href="https://aiwting.github.io/1/nvt.mdp" target="_blank" rel="noreferrer">nvt.mdp</a> 文件。</li><li>进行时长100ps的平衡</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx grompp -f nvt.mdp -c em.gro -r em.gro -p 1aki.top -o nvt.tpr</span></span>
<span class="line"><span>                :-) GROMACS - gmx grompp, 2024.3-conda_forge (-:</span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx grompp -f nvt.mdp -c em.gro -r em.gro -p 1aki.top -o nvt.tpr</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>This run will generate roughly 37 Mb of data</span></span>
<span class="line"><span>GROMACS reminds you: &quot;Be less curious about people and more curious about ideas.&quot; (Marie Curie)</span></span>
<span class="line"><span>// 然后运行mdrun</span></span>
<span class="line"><span>$ gmx mdrun -deffnm nvt -v</span></span>
<span class="line"><span>                :-) GROMACS - gmx mdrun, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx mdrun -deffnm nvt -v</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>starting mdrun &#39;LYSOZYME in water&#39;</span></span>
<span class="line"><span>50000 steps,    100.0 ps.</span></span>
<span class="line"><span>step 14200: timed with pme grid 48 48 48, coulomb cutoff 1.000: 65.5 M-cycles</span></span>
<span class="line"><span>step 14400: timed with pme grid 42 42 42, coulomb cutoff 1.073: 61.0 M-cycles</span></span>
<span class="line"><span>step 14600: timed with pme grid 36 36 36, coulomb cutoff 1.252: 187.5 M-cycles</span></span>
<span class="line"><span>step 14800: timed with pme grid 40 40 40, coulomb cutoff 1.127: 102.2 M-cycles</span></span>
<span class="line"><span>step 15000: timed with pme grid 42 42 42, coulomb cutoff 1.073: 95.6 M-cycles</span></span>
<span class="line"><span>step 15200: timed with pme grid 44 44 44, coulomb cutoff 1.025: 81.5 M-cycles</span></span>
<span class="line"><span>step 15400: timed with pme grid 48 48 48, coulomb cutoff 1.000: 76.6 M-cycles</span></span>
<span class="line"><span>              optimal pme grid 42 42 42, coulomb cutoff 1.073</span></span>
<span class="line"><span>step 26700, remaining wall clock time:    10 s</span></span>
<span class="line"><span>// 等待计算完成</span></span>
<span class="line"><span>Writing final coordinates.</span></span>
<span class="line"><span>step 50000, remaining wall clock time:     0 s</span></span>
<span class="line"><span>               Core t (s)   Wall t (s)        (%)</span></span>
<span class="line"><span>       Time:      121.848       20.310      599.9</span></span>
<span class="line"><span>                 (ns/day)    (hour/ns)</span></span>
<span class="line"><span>Performance:      425.410        0.056</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;Alas, You&#39;re Welcome&quot; (Prof. Dumbledore in Potter Puppet Pals)</span></span></code></pre></div><ul><li>再次使用energy来分析温度的变化：在提示符处键入“16 0”以选择系统的温度并退出。</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx energy -f nvt.edr -o temperature.xvg</span></span>
<span class="line"><span>                :-) GROMACS - gmx energy, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx energy -f nvt.edr -o temperature.xvg</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Opened nvt.edr as single precision energy file</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Select the terms you want from the following list by</span></span>
<span class="line"><span>selecting either (part of) the name or the number or a combination.</span></span>
<span class="line"><span>End your selection with an empty line or a zero.</span></span>
<span class="line"><span>-------------------------------------------------------------------</span></span>
<span class="line"><span>  1  Bond             2  Angle            3  Proper-Dih.      4  Per.-Imp.-Dih.</span></span>
<span class="line"><span>  5  LJ-14            6  Coulomb-14       7  LJ-(SR)          8  Disper.-corr.</span></span>
<span class="line"><span>  9  Coulomb-(SR)    10  Coul.-recip.    11  Position-Rest.  12  Potential</span></span>
<span class="line"><span> 13  Kinetic-En.     14  Total-Energy    15  Conserved-En.   16  Temperature</span></span>
<span class="line"><span> 17  Pres.-DC        18  Pressure        19  Constr.-rmsd    20  Vir-XX</span></span>
<span class="line"><span> 21  Vir-XY          22  Vir-XZ          23  Vir-YX          24  Vir-YY</span></span>
<span class="line"><span> 25  Vir-YZ          26  Vir-ZX          27  Vir-ZY          28  Vir-ZZ</span></span>
<span class="line"><span> 29  Pres-XX         30  Pres-XY         31  Pres-XZ         32  Pres-YX</span></span>
<span class="line"><span> 33  Pres-YY         34  Pres-YZ         35  Pres-ZX         36  Pres-ZY</span></span>
<span class="line"><span> 37  Pres-ZZ                             38  #Surf*SurfTen</span></span>
<span class="line"><span> 39  T-Protein                           40  T-Water_and_ions</span></span>
<span class="line"><span> 41  Lamb-Protein                        42  Lamb-Water_and_ions</span></span>
<span class="line"><span>$ 16 0</span></span>
<span class="line"><span>Last energy frame read 100 time  100.000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Statistics over 50001 steps [ 0.0000 through 100.0000 ps ], 1 data sets</span></span>
<span class="line"><span>All statistics are over 501 points</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Energy                      Average   Err.Est.       RMSD  Tot-Drift</span></span>
<span class="line"><span>-------------------------------------------------------------------------------</span></span>
<span class="line"><span>Temperature                 300.134        0.1    3.27203   0.620947  (K)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;You are wrong!&quot; (NOFX)</span></span></code></pre></div><ul><li>输入<code>xmgrace temperature.xvg</code>查看温度变化，生成的图应如下：从图中可以看出系统的温度迅速达到目标值（300 K）附近。</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-2.png" width="60%" align="center"></p><p><em>系统的温度变化</em> :::</p><h2 id="步骤7-npt平衡" tabindex="-1">步骤7-NPT平衡 <a class="header-anchor" href="#步骤7-npt平衡" aria-label="Permalink to &quot;步骤7-NPT平衡&quot;">​</a></h2><blockquote><p>GROMACS工具：grompp, mdrun, energy</p></blockquote><ul><li>过程几乎与nvt平衡类似，进行100ps，开启位置限制。</li><li>这里可以找到 <a href="https://aiwting.github.io/1/npt.mdp" target="_blank" rel="noreferrer">npt.mdp</a> 文件，注意mdp文件中的一些变化 <ul><li><code>continuation = yes</code>表示从NVT平衡阶段继续模拟</li><li><code>gen_vel = no</code>表示从轨迹中读取速度</li></ul></li><li><code>-t</code>指定上一步生成的检查点文件.cpt，存储了上一步模拟过程中的完整状态信息。配合上述mdp文件的参数使用。</li><li>这里可能会出现一个警告warning，在最新版本的GROMACS中会出现，不用管它，这是官方在推荐使用一种新的恒压方法。在命令最后添加 <code>-maxwarn 1</code>重新运行。</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx grompp -f npt.mdp -c nvt.gro -r nvt.gro -t nvt.cpt -p 1aki.top -o npt.tpr</span></span>
<span class="line"><span>WARNING 1 [file npt.mdp]:</span></span>
<span class="line"><span>  The Berendsen barostat does not generate any strictly correct ensemble,</span></span>
<span class="line"><span>  and should not be used for new production simulations (in our opinion).</span></span>
<span class="line"><span>  We recommend using the C-rescale barostat instead.</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>There was 1 WARNING</span></span>
<span class="line"><span>-------------------------------------------------------</span></span>
<span class="line"><span>Program:     gmx grompp, version 2024.3-conda_forge</span></span>
<span class="line"><span>Source file: src/gromacs/gmxpreprocess/grompp.cpp (line 2751)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Fatal error:</span></span>
<span class="line"><span>Too many warnings (1).</span></span>
<span class="line"><span>If you are sure all warnings are harmless, use the -maxwarn option.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>For more information and tips for troubleshooting, please check the GROMACS</span></span>
<span class="line"><span>website at https://manual.gromacs.org/current/user-guide/run-time-errors.html</span></span>
<span class="line"><span>-------------------------------------------------------</span></span>
<span class="line"><span>// warning 忽略它重新运行</span></span>
<span class="line"><span>$ gmx grompp -f npt.mdp -c nvt.gro -r nvt.gro -t nvt.cpt -p 1aki.top -o npt.tpr -maxwarn 1</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>// 然后运行mdrun</span></span>
<span class="line"><span>$ gmx mdrun -deffnm npt</span></span>
<span class="line"><span>......</span></span></code></pre></div><ul><li>再次使用energy来分析压强、密度的变化：</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx energy -f npt.edr -o pressure.xvg</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>$ 18 0</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>$ gmx energy -f npt.edr -o density.xvg</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>$ 24 0</span></span>
<span class="line"><span>......</span></span></code></pre></div><ul><li>再次执行绘图命令 <code>xmgrace pressure.xvg</code>，<code>xmgrace density.xvg</code>，压力和密度均很快达到平衡，表明系统现在在压力和密度方面平衡良好。</li><li>压力值在平衡阶段的过程中波动很大，但不用担心，压力是一个在MD模拟过程中波动很大的量。</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-3.png" width="60%" align="center"></p><p><em>系统的压力变化</em> :::</p><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-4.png" width="60%" align="center"></p><p><em>系统的密度变化</em> :::</p><h2 id="步骤8-md模拟" tabindex="-1">步骤8-MD模拟 <a class="header-anchor" href="#步骤8-md模拟" aria-label="Permalink to &quot;步骤8-MD模拟&quot;">​</a></h2><ul><li>在完成两个平衡阶段后，系统现在在所需的温度和压力下充分平衡。</li><li>操作流程几乎类似npt平衡，区别在于关闭位置限制，因此不需要 <code>-r</code>参数；继续从上一个模拟过程开始，因此 <code>-t</code>指定上一个过程生成的cpt文件。</li><li>动力学模拟的参数文件可以在这里找到 <a href="https://aiwting.github.io/1/md.mdp" target="_blank" rel="noreferrer">md.mdp</a></li><li>同样使用 <code>-maxwarn 1</code>忽略压力平衡器的警告</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx grompp -f md.mdp -c npt.gro -t npt.cpt -p 1aki.top -o md0.tpr -maxwarn 1</span></span>
<span class="line"><span>                :-) GROMACS - gmx grompp, 2024.3-conda_forge (-:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Executable:   /home/zz/miniconda3/envs/md/bin.AVX2_256/gmx</span></span>
<span class="line"><span>Data prefix:  /home/zz/miniconda3/envs/md</span></span>
<span class="line"><span>Working dir:  /mnt/e/share/teach</span></span>
<span class="line"><span>Command line:</span></span>
<span class="line"><span>  gmx grompp -f md.mdp -c npt.gro -t npt.cpt -p 1aki.top -o md0.tpr -maxwarn 1</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>WARNING 1 [file md.mdp]:</span></span>
<span class="line"><span>  13397 atoms are not part of any center of mass motion removal group.</span></span>
<span class="line"><span>  This may lead to artifacts.</span></span>
<span class="line"><span>  In most cases one should use one group for the whole system.</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>There was 1 WARNING</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;Is That a Real Poncho ?&quot; (F. Zappa)</span></span>
<span class="line"><span>// 然后执行MD模拟，花费时间因机器性能而异（几分钟~1个多小时）</span></span>
<span class="line"><span>$ gmx mdrun -deffnm md0 -v</span></span>
<span class="line"><span>                :-) GROMACS - gmx mdrun, 2024.3-conda_forge (-:</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>step 499900, remaining wall clock time:     0 s</span></span>
<span class="line"><span>Writing final coordinates.</span></span>
<span class="line"><span>step 500000, remaining wall clock time:     0 s</span></span>
<span class="line"><span>               Core t (s)   Wall t (s)        (%)</span></span>
<span class="line"><span>       Time:      830.063      138.346      600.0</span></span>
<span class="line"><span>                 (ns/day)    (hour/ns)</span></span>
<span class="line"><span>Performance:      624.522        0.038</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROMACS reminds you: &quot;Developer accused of unreadable code refuses to comment&quot; (Molly Struve)</span></span></code></pre></div><p><strong>恭喜你完成了一个完整的GROMACS模拟案例! 接下来是简单的分析.</strong></p><h2 id="模拟后处理与分析" tabindex="-1">模拟后处理与分析 <a class="header-anchor" href="#模拟后处理与分析" aria-label="Permalink to &quot;模拟后处理与分析&quot;">​</a></h2><h3 id="观察运动轨迹" tabindex="-1">观察运动轨迹 <a class="header-anchor" href="#观察运动轨迹" aria-label="Permalink to &quot;观察运动轨迹&quot;">​</a></h3><ul><li>用VMD查看模拟轨迹，可以发现溶菌酶分子在水中的运动情况。</li><li>由于执行MD模拟时开启了去除蛋白质的质心平移(在 md.mdp 文件中: &quot;comm-grps = Protein&quot;), 溶菌酶分子几乎在盒子中心旋转而不会越出盒子边界.</li></ul><p>:::{figure-md} <img src="http://101.201.29.162:8899/i/2025/07/17/x8evx5-0.gif" width="90%" align="center"></p><p><em>溶菌酶在水中的模拟轨迹图</em> :::</p><h3 id="轨迹文件处理" tabindex="-1">轨迹文件处理 <a class="header-anchor" href="#轨迹文件处理" aria-label="Permalink to &quot;轨迹文件处理&quot;">​</a></h3><blockquote><p>GROMACS工具：trjconv</p></blockquote><ul><li>如果你的目标分子跑出盒子处于盒子边界处（这里不会因为mdp文件中设置消除了蛋白质的质心运动），需要 <code>trjconv</code>来调整轨迹文件位置。</li><li>本案例可以不执行.</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gmx trjconv -s md0.tpr -f md0.xtc -o md0_noPBC.xtc -pbc mol -center</span></span>
<span class="line"><span>// 选择1（“Protein”）作为要居中的组，选择0（“System”）作为输出。</span></span></code></pre></div><ul><li>此外 <code>trjconv</code>还可以转换轨迹文件格式，调整轨迹步数间隔，输出某一段的轨迹文件、输出某些步的结构文件等等。</li></ul><h3 id="计算根均方偏差rmsd" tabindex="-1">计算根均方偏差RMSD <a class="header-anchor" href="#计算根均方偏差rmsd" aria-label="Permalink to &quot;计算根均方偏差RMSD&quot;">​</a></h3><blockquote><p>GROMACS工具：rms</p></blockquote><ul><li>蛋白质的RMSD反映了模拟的收敛性和蛋白的稳定性.</li><li><code>rms</code> 计算模拟过程中的结构与初始结构的RMSD，程序会对结构进行最小二乘拟合并给出RMSD随时间的变化，将得到一个xvg文件，包含了RMSD随时间的变化。</li><li><code>-tu</code>表示设置输出时间单位, 这里设置为 ns</li></ul><div class="language-term vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">term</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 以经过两步平衡后的结构为参考结构</span></span>
<span class="line"><span>$ gmx rms -s md0.tpr -f md0.xtc -o rmsd.xvg -tu ns</span></span>
<span class="line"><span>// 选择3（“α碳”），两次选择相同的组</span></span>
<span class="line"><span>$ 3 3</span></span>
<span class="line"><span>// 再与晶体结构作为参考结构做一下对比</span></span>
<span class="line"><span>$ gmx rms -s em.tpr -f md0.xtc -o rmsd_crystal.xvg -tu ns</span></span>
<span class="line"><span>$ 3 3</span></span>
<span class="line"><span>// 然后用xmgrace绘图</span></span>
<span class="line"><span>$ xmgrace rmsd.xvg rmsd_crystal.xvg</span></span></code></pre></div><ul><li>结果看起来像这样：</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-6.png" width="90%" align="center"></p><p><em>溶菌酶α碳的RMSD</em> :::</p><ul><li>可以看到RMSD很快稳定到一个较小的值，并在后续保持。这说明溶菌酶分子在水中结构非常稳定波动很小，且该模拟很容易达到平衡，与该晶体结构略有细微差异。</li></ul><h3 id="蛋白质回旋半径" tabindex="-1">蛋白质回旋半径 <a class="header-anchor" href="#蛋白质回旋半径" aria-label="Permalink to &quot;蛋白质回旋半径&quot;">​</a></h3><blockquote><p>GROMACS工具：gyrate</p></blockquote><ul><li>蛋白质的回转半径是其致密性的衡量标准：回旋半径取决于某(些)原子质量与分子重心的关系, 因此可用于表征蛋白质结构的密实度。</li><li>如果一个蛋白质是稳定折叠态，它将可能保持相对稳定的Rg值。如果一个蛋白质展开，它的Rg会随着时间的推移而改变。</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gyrate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.tpr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md0.xtc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gyrate.xvg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选择第1组（“Protein”）进行分析</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 绘图</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmgrace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gyrate.xvg</span></span></code></pre></div><ul><li>从平稳的Rg值看出，溶菌酶在300 K 下 1 ns 的过程中保持非常稳定的折叠状态：</li></ul><p>:::{figure-md} <img src="https://2301032.xyz/lysinwater-7.png" width="80%" align="center"></p><p><em>溶菌酶分子的回旋半径</em> :::</p><p><strong>至此，我们完成了水中溶菌酶的全部模拟并进行了简单的分析！你应该熟悉了GROMACS的基本模拟流程，一些常用的GROMACS工具（模块）及其命令。</strong></p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/VScode%E5%85%A5%E9%97%A8.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>VScode入门</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/%E5%AE%89%E8%A3%85GROMACS.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>安装GROMACS</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><!----><p class="copyright" data-v-566314d4>&copy; 2024 Aiwting.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"73v53_fJ\",\"分子模拟_contact.md\":\"CaUm1Z0d\",\"分子模拟_readme.md\":\"0u_zyD99\",\"分子模拟_必备技能_amber概述.md\":\"3ilXDyL1\",\"分子模拟_必备技能_cellulose-builder.md\":\"DTyk3hai\",\"分子模拟_必备技能_conda入门.md\":\"CV_dHc5c\",\"分子模拟_必备技能_glycam力场介绍.md\":\"CGNuf5oD\",\"分子模拟_必备技能_gromacs概述.md\":\"BPepIumj\",\"分子模拟_必备技能_vscode入门.md\":\"B7KmO6Qd\",\"分子模拟_快速入门_入门案例1.md\":\"DWgG6Gxr\",\"分子模拟_快速入门_安装gromacs.md\":\"Cf4tz08U\",\"分子模拟_快速入门_安装linux.md\":\"N5qK9Id2\",\"分子模拟_案例复现_纤维素-聚丙烯复合材料.md\":\"DL3b0mUn\",\"分子模拟_背景知识_分子力学概述.md\":\"DPBIGYt3\",\"分子模拟_背景知识_分子动力学概述.md\":\"BkI3IoaG\",\"分子模拟_背景知识_分子对接概述.md\":\"BA1LvoBj\",\"分子模拟_背景知识_分子建模.md\":\"llXi0U8N\",\"分子模拟_背景知识_分子模拟概述.md\":\"P3uaXaNN\",\"分子模拟_背景知识_国内外研究进展.md\":\"5WUyI_1K\",\"分子模拟_背景知识_如何判断模拟达到平衡.md\":\"CEuM--kD\",\"分子模拟_背景知识_模拟参数的设置.md\":\"DktnpjmB\",\"分子模拟_背景知识_模拟退火.md\":\"BDs871Fv\",\"分子模拟_背景知识_相互作用力.md\":\"CUwLrlOM\",\"分子模拟_背景知识_粗粒化模拟.md\":\"Dui6GaeQ\",\"分子模拟_背景知识_统计力学.md\":\"CxJxE-sy\",\"分子模拟_背景知识_自由能计算.md\":\"Bxx420VS\",\"分子模拟_背景知识_蒙特卡洛.md\":\"B_IiwQD-\",\"分子模拟_背景知识_蛋白质二级结构.md\":\"BrTgNUri\",\"分子模拟_背景知识_量子化学概述.md\":\"D45MM6Kw\",\"分子模拟_背景知识_静电计算.md\":\"BWNqszJL\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Molecular Simulation\",\"description\":\"Understand molecular simulation\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"分子模拟\",\"link\":\"/分子模拟/README.md\"},{\"text\":\"联系我\",\"link\":\"/分子模拟/Contact.md\"}],\"outline\":[1,5],\"outlineTitle\":\"目录\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/aiwting/\"}],\"footer\":{\"copyright\":\"&copy; 2024 Aiwting.\"},\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"resetButtonTitle\":\"清除查询条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\"}}}}},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"sidebar\":{\"/分子模拟/\":{\"base\":\"/分子模拟/\",\"items\":[{\"text\":\"Contact\",\"link\":\"Contact\"},{\"text\":\"README\",\"link\":\"README\"},{\"text\":\"必备技能\",\"items\":[{\"text\":\"Amber概述\",\"link\":\"必备技能/Amber概述\"},{\"text\":\"Cellulose-Builder\",\"link\":\"必备技能/Cellulose-Builder\"},{\"text\":\"Conda入门\",\"link\":\"必备技能/Conda入门\"},{\"text\":\"GLYCAM力场介绍\",\"link\":\"必备技能/GLYCAM力场介绍\"},{\"text\":\"GROMACS概述\",\"link\":\"必备技能/GROMACS概述\"},{\"text\":\"VScode入门\",\"link\":\"必备技能/VScode入门\"}],\"collapsed\":false},{\"text\":\"快速入门\",\"items\":[{\"text\":\"入门案例1\",\"link\":\"快速入门/入门案例1\"},{\"text\":\"安装GROMACS\",\"link\":\"快速入门/安装GROMACS\"},{\"text\":\"安装Linux\",\"link\":\"快速入门/安装Linux\"}],\"collapsed\":false},{\"text\":\"案例复现\",\"items\":[{\"text\":\"纤维素-聚丙烯复合材料\",\"link\":\"案例复现/纤维素-聚丙烯复合材料\"}],\"collapsed\":false},{\"text\":\"背景知识\",\"items\":[{\"text\":\"分子力学概述\",\"link\":\"背景知识/分子力学概述\"},{\"text\":\"分子动力学概述\",\"link\":\"背景知识/分子动力学概述\"},{\"text\":\"分子对接概述\",\"link\":\"背景知识/分子对接概述\"},{\"text\":\"分子建模\",\"link\":\"背景知识/分子建模\"},{\"text\":\"分子模拟概述\",\"link\":\"背景知识/分子模拟概述\"},{\"text\":\"国内外研究进展\",\"link\":\"背景知识/国内外研究进展\"},{\"text\":\"如何判断模拟达到平衡\",\"link\":\"背景知识/如何判断模拟达到平衡\"},{\"text\":\"模拟参数的设置\",\"link\":\"背景知识/模拟参数的设置\"},{\"text\":\"模拟退火\",\"link\":\"背景知识/模拟退火\"},{\"text\":\"相互作用力\",\"link\":\"背景知识/相互作用力\"},{\"text\":\"粗粒化模拟\",\"link\":\"背景知识/粗粒化模拟\"},{\"text\":\"统计力学\",\"link\":\"背景知识/统计力学\"},{\"text\":\"自由能计算\",\"link\":\"背景知识/自由能计算\"},{\"text\":\"蒙特卡洛\",\"link\":\"背景知识/蒙特卡洛\"},{\"text\":\"蛋白质二级结构\",\"link\":\"背景知识/蛋白质二级结构\"},{\"text\":\"量子化学概述\",\"link\":\"背景知识/量子化学概述\"},{\"text\":\"静电计算\",\"link\":\"背景知识/静电计算\"}],\"collapsed\":false}]}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>